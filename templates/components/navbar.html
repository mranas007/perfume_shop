<nav id="navbar" class="fixed w-full z-30 transition-all duration-300 bg-gray-900 backdrop-blur-sm py-4">
    <div class="mx-auto px-4">
        <div class="flex justify-between items-center">
            <!-- Logo -->
            <div class="flex items-center">
                <a href="{% url 'home' %}" class="desk-nav text-2xl font-bold text-white drop-shadow-lg hover:scale-105 transition-transform duration-300">
                    <span class="text-amber-400">Adnan</span>Perfume
                </a>
            </div>

            <!-- Desktop Navigation -->
            <div class="hidden lg:flex items-center space-x-8">
                <a href="{% url 'home' %}" class="desk-nav font-medium text-white hover:text-amber-400 transition relative group">
                    Home
                    <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-amber-400 group-hover:w-full {% if request.path == '/' %}w-full{% endif %} transition-all duration-300"></span>
                </a>
                <a href="{% url 'catalog:index' %}" class="desk-nav font-medium text-white hover:text-amber-400 transition relative group">
                    Catalog
                    <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-amber-400 group-hover:w-full {% if '/catalog' in request.path %}w-full{% endif %} transition-all duration-300"></span>
                </a>
                <a href="{% url 'about' %}" class="desk-nav font-medium text-white hover:text-amber-400 transition relative group">
                    About Us
                    <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-amber-400 group-hover:w-full {% if '/about' in request.path %}w-full{% endif %} transition-all duration-300"></span>
                </a>
                <a href="{% url 'contact_us' %}" class="desk-nav font-medium text-white hover:text-amber-400 transition relative group">
                    Contact
                    <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-amber-400 group-hover:w-full {% if '/contact' in request.path %}w-full{% endif %} transition-all duration-300"></span>
                </a>
            </div>

            <!-- Right Side (Auth + Cart + Mobile Button) -->
            <div class="flex items-center space-x-4">
                {% if user.is_authenticated%}
                <!-- Cart Icon (Desktop) -->
                    {% if user.is_staff is not True %}
                        <a href="{% url 'cart:cart_detail' %}" class="hidden lg:flex items-center relative p-2 text-white hover:text-amber-400 transition-colors">
                            {% load static %}
                            <img src="{% static 'icons/shopping-cart-outline-svgrepo-com.svg' %}" alt="Shopping Cart" class="w-6 h-6 filter-white">
                            {% if cart_count > 0 %}
                                <span   
                                class="absolute bg-amber-500 text-white text-xs font-bold rounded-full h-4 w-4 flex items-center justify-center"
                                style="top: 0px;right: 0px;">
                                    {{ cart_count }}
                                </span>
                            {% endif %}
                        </a>
                    {% endif %}

                <!-- Desktop Profile Dropdown -->
                <div class="hidden lg:block relative">
                    <button id="profileDropdownBtn" class="flex items-center py-2 px-3 text-white hover:text-amber-400 transition">
                        <span class="flex items-center">
                            <span class="w-8 h-8 rounded-full bg-amber-500 flex items-center justify-center text-white font-medium mr-2">
                                {{ user.name|slice:":1"|upper }}
                            </span>
                            <span>{{ user.name }}</span>
                        </span>
                        <svg class="w-3 h-3 ml-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 4 4 4-4"/>
                        </svg>
                    </button>
                    <!-- Desktop Dropdown menu -->
                    <div id="profileDropdownMenu" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg z-50">
                        <ul class="py-2 text-sm text-gray-700">
                            {% if user.is_staff %}
                                <li><a href="{% url 'admin:index' %}" class="block px-4 py-2 hover:bg-gray-100">Admin Panel</a></li>
                            {% endif %}
                            <li><a href="{% url 'accounts:profile' %}" class="block px-4 py-2 hover:bg-gray-100">Profile</a></li>
                            {% if user.is_staff is not True%}
                                <li><a href="{% url 'orders:index' %}" class="block px-4 py-2 hover:bg-gray-100">My Orders</a></li>
                            {% endif %}
                        </ul>
                        <div class="py-1 border-t border-gray-200">
                            <form action="{% url 'accounts:logout' %}" method="post">
                                {% csrf_token %}
                                <button type="submit" class="w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50">
                                    Logout
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
                {% else %}
                <!-- Desktop Auth Buttons -->
                <div class="hidden lg:flex items-center space-x-3">
                    <a href="{% url 'accounts:login' %}" class="text-amber-400 px-4 py-2 border border-amber-400 rounded-full hover:bg-amber-400 hover:text-white transition-all text-sm font-medium">
                        Login
                    </a>
                    <a href="{% url 'accounts:register' %}" class="px-4 py-2 bg-amber-500 hover:bg-amber-600 text-white rounded-full transition-colors text-sm font-medium">
                        Register
                    </a>
                </div>
                {% endif %}

                <!-- Cart Icon (Mobile) -->
                {% if user.is_authenticated %}
                <a href="{% url 'cart:cart_detail' %}" class="lg:hidden relative p-2 text-white hover:text-amber-400 transition-colors">
                    {% load static %}
                    <img src="{% static 'icons/shopping-cart-outline-svgrepo-com.svg' %}" alt="Shopping Cart" class="w-6 h-6 filter-white">
                    {% if cart_count > 0 %}
                    <span 
                        class="absolute bg-amber-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center"
                        style="top: -1px;right: -1px;">
                        {{ cart_count }}
                    </span>
                    {% endif %}
                </a>
                {% endif %}

                <!-- Mobile menu button -->
                <div class="lg:hidden">
                    <button id="mobileMenuBtn" class="text-white hover:text-amber-400 focus:outline-none transition p-2">
                        <svg id="mobileMenuIconOpen" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                        </svg>
                        <svg id="mobileMenuIconClose" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Menu (slides down instead of side panel) -->
        <div id="mobileMenu" class="lg:hidden hidden bg-gray-800 mt-4 rounded-lg shadow-lg overflow-hidden">
            <!-- Navigation Links -->
            <div class="py-4">
                <a href="{% url 'home' %}" class="block px-6 py-3 text-white hover:text-amber-400 hover:bg-gray-700 transition font-medium {% if request.path == '/' %}bg-gray-700 text-amber-400{% endif %}">
                    Home
                </a>
                <a href="{% url 'catalog:index' %}" class="block px-6 py-3 text-white hover:text-amber-400 hover:bg-gray-700 transition font-medium {% if '/catalog' in request.path %}bg-gray-700 text-amber-400{% endif %}">
                    Catalog
                </a>
                <a href="{% url 'about' %}" class="block px-6 py-3 text-white hover:text-amber-400 hover:bg-gray-700 transition font-medium {% if '/about' in request.path %}bg-gray-700 text-amber-400{% endif %}">
                    About Us
                </a>
                <a href="{% url 'contact_us' %}" class="block px-6 py-3 text-white hover:text-amber-400 hover:bg-gray-700 transition font-medium {% if '/contact' in request.path %}bg-gray-700 text-amber-400{% endif %}">
                    Contact
                </a>
            </div>

            <!-- Mobile Auth/Profile Section -->
            <div class="border-t border-gray-700 py-4">
                {% if user.is_authenticated %}
                <!-- Mobile Profile Section -->
                <div class="px-6 py-3">
                    <div class="flex items-center mb-4">
                        <span class="w-10 h-10 rounded-full bg-amber-500 flex items-center justify-center text-white font-medium mr-3">
                            {{ user.name|slice:":1"|upper }}
                        </span>
                        <span class="text-white font-medium">{{ user.name }}</span>
                    </div>
                    <div class="space-y-2">
                        {% if user.is_staff %}
                        <a href="{% url 'admin:index' %}" class="block px-4 py-2 text-gray-300 hover:text-amber-400 hover:bg-gray-700 rounded transition">
                            Admin Panel
                        </a>
                        {% endif %}
                        <a href="{% url 'accounts:profile' %}" class="block px-4 py-2 text-gray-300 hover:text-amber-400 hover:bg-gray-700 rounded transition">
                            Profile
                        </a>
                        <a href="{% url 'cart:cart_detail' %}" class="block px-4 py-2 text-gray-300 hover:text-amber-400 hover:bg-gray-700 rounded transition">
                            My Cart {% if cart_count > 0 %}({{ cart_count }}){% endif %}
                        </a>
                        <a href="{% url 'orders:index' %}" class="block px-4 py-2 text-gray-300 hover:text-amber-400 hover:bg-gray-700 rounded transition">
                            My Orders
                        </a>
                        <form action="{% url 'accounts:logout' %}" method="post" class="mt-4">
                            {% csrf_token %}
                            <button type="submit" class="w-full text-left px-4 py-2 text-red-400 hover:text-red-300 hover:bg-gray-700 rounded transition">
                                Logout
                            </button>
                        </form>
                    </div>
                </div>
                {% else %}
                <!-- Mobile Auth Buttons -->
                <div class="px-6 space-y-3">
                    <a href="{% url 'accounts:login' %}" class="block w-full py-3 text-center border border-amber-400 text-amber-400 rounded-full hover:bg-amber-400 hover:text-white transition font-medium">
                        Login
                    </a>
                    <a href="{% url 'accounts:register' %}" class="block w-full py-3 text-center bg-amber-500 hover:bg-amber-600 text-white rounded-full transition font-medium">
                        Register
                    </a>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</nav>

<style>
/* Make cart icon white to match navbar */
.filter-white {
    filter: brightness(0) invert(1);
}

/* Hover effect for cart icon */
.filter-white:hover {
    filter: brightness(0) invert(0.8) sepia(1) saturate(5) hue-rotate(25deg);
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Desktop Profile Dropdown (simple toggle)
    const profileBtn = document.getElementById('profileDropdownBtn');
    const profileMenu = document.getElementById('profileDropdownMenu');

    if (profileBtn && profileMenu) {
        profileBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            profileMenu.classList.toggle('hidden');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            if (!profileMenu.classList.contains('hidden') && !profileMenu.contains(e.target)) {
                profileMenu.classList.add('hidden');
            }
        });
    }

    // Mobile Menu (super simple toggle)
    const mobileMenuBtn = document.getElementById('mobileMenuBtn');
    const mobileMenu = document.getElementById('mobileMenu');
    const openIcon = document.getElementById('mobileMenuIconOpen');
    const closeIcon = document.getElementById('mobileMenuIconClose');

    if (mobileMenuBtn && mobileMenu) {
        mobileMenuBtn.addEventListener('click', function() {
            // Toggle menu visibility
            mobileMenu.classList.toggle('hidden');

            // Toggle icons
            openIcon.classList.toggle('hidden');
            closeIcon.classList.toggle('hidden');
        });

        // Close mobile menu when clicking on navigation links
        const mobileLinks = mobileMenu.querySelectorAll('a');
        mobileLinks.forEach(link => {
            link.addEventListener('click', function() {
                mobileMenu.classList.add('hidden');
                openIcon.classList.remove('hidden');
                closeIcon.classList.add('hidden');
            });
        });
    }
});
</script>